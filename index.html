<!DOCTYPE html>
<html lang="ru">
<голова>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TopSerials — Мультсериалы</title>
  <стиль>
    тело {
      семейство шрифтов: Arial, без засечек;
      поле: 0;
      отступ: 0;
      переход: фоновый цвет 0,3 с, цвет 0,3 с;
      цвет фона: #f0f2f5;
      цвет: #000;
    }
    заголовок {
      фоновый цвет: #222;
      цвет: белый;
      отступ: 20px;
      выравнивание текста: по центру;
    }
    кнопка заголовка {
      отступ сверху: 10px;
      отступы: 6px 12px;
      граница: нет;
      Радиус закругления: 6 пикселей;
      фон: #444;
      цвет: #fff;
      курсор: указатель;
    }
    .контроллеры {
      дисплей: гибкий;
      flex-wrap: обертывание;
      justify-content: center;
      зазор: 10 пикселей;
      поле: 10px 0;
    }
    .выбор элементов управления, .кнопка элементов управления {
      отступы: 6px 12px;
      размер шрифта: 14px;
      Радиус закругления: 6 пикселей;
    }
    .контейнер {
      отображение: сетка;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      зазор: 20 пикселей;
      отступ: 20px;
    }
    .карта {
      фон: белый;
      радиус скругления: 12 пикселей;
      переполнение: скрыто;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      переход: преобразование 0,2с;
    }
    .card:hover {
      преобразование: масштаб(1.02);
    }
    .карта img {
      ширина: 100%;
      высота: 350 пикселей;
      объект-подгонка: крышка;
    }
    .card-content {
      отступ: 15px;
    }
    .заголовок {
      размер шрифта: 18px;
      начертание шрифта: жирный;
      отступ снизу: 8px;
    }
    .рейтинг, .дата {
      размер шрифта: 14px;
      цвет: #555;
    }
  </стиль>
</head>
<тело>
  <заголовок>
    <h1>TopSerials: Нравится</h1>
    <p>Р¤РёР»СЊСЂР°С†РёСЏ РїРѕ РіРѕРґСѓ, СЂРµР№С‚РёРЅРіСѓ, Р¶Р°РЅСЂСѓ. Расширенный интерфейс TMDB API</p>
    <button id="theme-toggle">подключиться</button>
  </заголовок>

  <div class="controls">
    <select id="genre-select">
      <option value="">Нет</option>
    </выбрать>
    <select id="year-select">
      <option value="">Добавка</option>
    </выбрать>
    <select id="rating-select">
      <option value="">Добавить</option>
      <option value="9">9+</option>
      <option value="8">8+</option>
      <option value="7">7+</option>
    </выбрать>
    <button onclick="loadSection('popular')">рџ”Ґ РўРѕРї 10</button>
    <button onclick="loadSection('airing_today')">рџ†• РќРѕРІРёРЅРєРё</button>
    <button onclick="loadSection('all')">рџЊЌ В'СЃеµ</button>
  </div>

  <div class="container" id="serials-container"></div>

  <скрипт>
    пусть allSerials = [];
    пусть genresMap = {};
    const apiKey = "c607e213bf2a729a00ee06646c9d82dd";
    const container = document.getElementById("serials-container");

    асинхронная функция fetchGenres() {
      const res = await fetch(`https://api.themoviedb.org/3/genre/tv/list?api_key=${apiKey}&language=ru-RU`);
      const data = await res.json();
      genresMap = Object.fromEntries(data.genres.map(g => [g.id, g.name]));
      const genreSelect = document.getElementById("genre-select");
      data.genres.forEach(g => {
        const opt = document.createElement("option");
        опт.значение = g.id;
        opt.textContent = g.name;
        genreSelect.appendChild(opt);
      });
    }

    асинхронная функция loadSection(тип) {
      пусть url;
      если (тип === "популярный") {
        url = `https://api.themoviedb.org/3/tv/popular?api_key=${apiKey}&language=ru-RU&page=1`;
      } иначе если (тип === "airing_today") {
        url = `https://api.themoviedb.org/3/tv/airing_today?api_key=${apiKey}&language=ru-RU&page=1`;
      } еще {
        url = `https://api.themoviedb.org/3/discover/tv?api_key=${apiKey}&language=ru-RU&sort_by=popularity.desc&page=1`;
      }
      const res = await fetch(url);
      const data = await res.json();
      allSerials = данные.результаты;
      renderSerials();
    }

    функция renderSerials() {
      const genreFilter = document.getElementById("genre-select").value;
      const yearFilter = document.getElementById("year-select").value;
      const ratingFilter = parseFloat(document.getElementById("rating-select").value) || 0;
      const filtered = allSerials.filter(s => {
        const жанрMatch = !genreFilter || s.genre_ids.includes(parseInt(genreFilter));
        const year = s.first_air_date ? s.first_air_date.split("-")[0] : "";
        const yearMatch = !yearFilter || year === yearFilter;
        const ratingMatch = s.vote_average >= ratingFilter;
        вернуть жанрСовпадение && годСовпадение && рейтингСовпадение;
      });

      контейнер.innerHTML = "";
      отфильтровано.forEach(s => {
        const жанры = s.genre_ids.map(id => genresMap[id]).join(", ");
        const year = s.first_air_date ? s.first_air_date.split("-")[0] : "—";
        контейнер.innerHTML += `
          <div class="card">
            <img src="https://image.tmdb.org/t/p/w500${s.poster_path}" alt="${s.name}">
            <div class="card-content">
              <div class="title">${s.name}</div>
              <div class="date"><strong>Год:</strong> ${year}</div>
              <div class="rating"><strong>РμР№С‚РёРЅРі:</strong> ${s.vote_average.toFixed(1)</div>
              <div class="rating"><strong>РанјрЂ:</strong> ${genres}</div>
            </div>
          </div>
        `;
      });
    }

    функция populateYears() {
      const yearSelect = document.getElementById("year-select");
      const currentYear = new Date().getFullYear();
      для (пусть y = текущий год; y >= 1980; y--) {
        const opt = document.createElement("option");
        опт.значение = y;
        opt.textContent = y;
        yearSelect.appendChild(opt);
      }
    }

    функция applyTheme(тема) {
      если (тема === "темная") {
        document.body.style.backgroundColor = "#121212";
        document.body.style.color = "#e0e0e0";
        document.getElementById("theme-toggle").textContent = "Оборудование";
      } еще {
        document.body.style.backgroundColor = "#f0f2f5";
        document.body.style.color = "#000";
        document.getElementById("theme-toggle").textContent = "подключиться";
      }
    }

    document.getElementById("theme-toggle").addEventListener("click", () => {
      const current = localStorage.getItem("theme") === "темный" ? "светлый" : "темный";
      localStorage.setItem("тема", текущая);
      applyTheme(текущая);
    });

    fetchGenres();
    populateYears();
    loadSection("популярные");
    const savedTheme = localStorage.getItem("theme") || "light";
    applyTheme(сохраненная тема);
  </скрипт>
</тело>
</html>
